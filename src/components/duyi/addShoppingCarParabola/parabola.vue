<template>
  <div class="container" ref="containerRef">
    <button class="btn" @click="handleAddEvent" ref="buttonRef">buy it</button>
    <div class="target" ref="targetRef">
      <svg
        width="70"
        height="70"
        viewBox="0 0 70 70"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M66.974 38.45a12.356 12.356 0 0 0-6.08-3.91 10.592 10.592 0 0 0 1.371-6.64 10.522 10.522 0 0 0-2.932-6.099 11.254 11.254 0 0 0-1.562-1.292 9.946 9.946 0 0 0-5.857-1.754 9.643 9.643 0 0 0-6.581 2.49 18.141 18.141 0 0 0-5.968-7.076 21.152 21.152 0 0 0-2.901-1.641A17.584 17.584 0 0 0 29.298 11c-2.467 0-4.907.52-7.165 1.528-.624.266-1.221.59-1.785.969a18.429 18.429 0 0 0-6.525 6.625 17.856 17.856 0 0 0-2.452 9.115c-.01.454.01.908.057 1.36a10.58 10.58 0 0 0-2.675.85A14.87 14.87 0 0 0 3.5 35.219a13.837 13.837 0 0 0-3.5 9.4 14.142 14.142 0 0 0 1.909 7.19 14.133 14.133 0 0 0 5.185 5.265c.535.328 1.094.612 1.673.85a13.314 13.314 0 0 0 5.354 1.075h43.719a11.638 11.638 0 0 0 4.661-.916 11.786 11.786 0 0 0 3.928-2.708 12.116 12.116 0 0 0 2.668-4.018c.613-1.508.92-3.127.901-4.758.003-3-1.073-5.898-3.025-8.15zm-9.2 18.798H14.056a11.624 11.624 0 0 1-5.354-1.246c-.29-.129-.57-.28-.837-.453a12.504 12.504 0 0 1-4.571-4.641 12.529 12.529 0 0 1-1.674-6.34A12.195 12.195 0 0 1 4.744 36.3a12.693 12.693 0 0 1 3.96-3.059 11.953 11.953 0 0 1 3.736-1.133l.836-.113-.111-.85a20.603 20.603 0 0 1-.111-1.938 16.13 16.13 0 0 1 2.175-8.21 16.806 16.806 0 0 1 5.911-6.002 15.521 15.521 0 0 1 8.087-2.21c3.26-.02 6.45.967 9.145 2.83a16.533 16.533 0 0 1 5.745 7.135c.058.113.112.171.112.284l.502 1.247.891-.969c.172-.202.358-.391.557-.565a8.075 8.075 0 0 1 5.745-2.323 8.2 8.2 0 0 1 5.856 2.261l.334.34a8.78 8.78 0 0 1 2.548 5.663 8.813 8.813 0 0 1-1.822 5.946l-.891 1.133 1.393.227c2.49.406 4.761 1.689 6.414 3.624a10.904 10.904 0 0 1 2.5 7.385A10.88 10.88 0 0 1 65.2 54.17a10.615 10.615 0 0 1-7.425 3.085v-.006z"
        />
      </svg>
    </div>
    <!--    <div-->
    <!--      class="add-card"-->
    <!--      style="&#45;&#45;left: 300px; &#45;&#45;top: 100px; &#45;&#45;y: 400px; &#45;&#45;x: -200px"-->
    <!--    >-->
    <!--      <svg-->
    <!--        width="22"-->
    <!--        height="16"-->
    <!--        viewBox="0 0 22 16"-->
    <!--        fill="none"-->
    <!--        xmlns="http://www.w3.org/2000/svg"-->
    <!--      >-->
    <!--        <path-->
    <!--          d="M6.40625 4.125C7.9375 2.5625 10.4688 2.5625 12.0312 4.125C13.5312 5.59375 13.5938 7.96875 12.25 9.5625L12.0625 9.75C11.875 9.96875 11.5625 10 11.375 9.8125C11.1562 9.625 11.125 9.3125 11.3125 9.09375L11.4688 8.90625C12.5 7.71875 12.4375 5.9375 11.3438 4.84375C10.1562 3.65625 8.28125 3.65625 7.09375 4.84375L3.21875 8.71875C2.03125 9.90625 2.03125 11.7812 3.21875 12.9688C4.375 14.125 6.28125 14.125 7.4375 12.9688L8.15625 12.25C8.34375 12.0625 8.65625 12.0625 8.875 12.25C9.0625 12.4375 9.0625 12.7812 8.875 12.9688L8.15625 13.6562C6.59375 15.2188 4.0625 15.2188 2.5 13.6562C0.9375 12.0938 0.9375 9.5625 2.5 8L6.40625 4.125ZM15.5625 11.9062C14.0312 13.4688 11.5 13.4688 9.9375 11.9062C8.4375 10.4375 8.375 8.0625 9.71875 6.46875L9.90625 6.28125C10.0938 6.0625 10.4062 6.03125 10.5938 6.21875C10.8125 6.40625 10.8438 6.71875 10.6562 6.9375L10.5 7.125C9.46875 8.3125 9.53125 10.0938 10.625 11.1875C11.8125 12.375 13.6875 12.375 14.875 11.1875L18.75 7.3125C19.9375 6.125 19.9375 4.25 18.75 3.0625C17.5938 1.90625 15.6875 1.90625 14.5312 3.0625L13.8125 3.78125C13.625 3.96875 13.3125 3.96875 13.0938 3.78125C12.9062 3.5625 12.9062 3.25 13.0938 3.0625L13.8125 2.34375C15.375 0.78125 17.9062 0.78125 19.4688 2.34375C21.0312 3.90625 21.0312 6.4375 19.4688 8L15.5625 11.9062Z"-->
    <!--          fill="white"-->
    <!--        />-->
    <!--      </svg>-->
    <!--    </div>-->
  </div>
</template>
<script setup>
// refer video: https://www.bilibili.com/video/BV1ZN411x7hf/?spm_id_from=top_right_bar_window_dynamic.content.click&vd_source=d45ec0638beff773cb15777eea2e0766
// 利用 css 設置變量，js去改變變量來達到動畫效果
// 拋物線可以用x y 座標來操作，透過父層變化來引導子層
import { ref } from 'vue'
const containerRef = ref(null)
const targetRef = ref(null)
const buttonRef = ref(null)
const createAddIcon = () => {
  const iconEle = document.createElement('div')
  iconEle.className = 'add-card'
  iconEle.innerHTML = `
      <svg
        width="22"
        height="16"
        viewBox="0 0 22 16"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M6.40625 4.125C7.9375 2.5625 10.4688 2.5625 12.0312 4.125C13.5312 5.59375 13.5938 7.96875 12.25 9.5625L12.0625 9.75C11.875 9.96875 11.5625 10 11.375 9.8125C11.1562 9.625 11.125 9.3125 11.3125 9.09375L11.4688 8.90625C12.5 7.71875 12.4375 5.9375 11.3438 4.84375C10.1562 3.65625 8.28125 3.65625 7.09375 4.84375L3.21875 8.71875C2.03125 9.90625 2.03125 11.7812 3.21875 12.9688C4.375 14.125 6.28125 14.125 7.4375 12.9688L8.15625 12.25C8.34375 12.0625 8.65625 12.0625 8.875 12.25C9.0625 12.4375 9.0625 12.7812 8.875 12.9688L8.15625 13.6562C6.59375 15.2188 4.0625 15.2188 2.5 13.6562C0.9375 12.0938 0.9375 9.5625 2.5 8L6.40625 4.125ZM15.5625 11.9062C14.0312 13.4688 11.5 13.4688 9.9375 11.9062C8.4375 10.4375 8.375 8.0625 9.71875 6.46875L9.90625 6.28125C10.0938 6.0625 10.4062 6.03125 10.5938 6.21875C10.8125 6.40625 10.8438 6.71875 10.6562 6.9375L10.5 7.125C9.46875 8.3125 9.53125 10.0938 10.625 11.1875C11.8125 12.375 13.6875 12.375 14.875 11.1875L18.75 7.3125C19.9375 6.125 19.9375 4.25 18.75 3.0625C17.5938 1.90625 15.6875 1.90625 14.5312 3.0625L13.8125 3.78125C13.625 3.96875 13.3125 3.96875 13.0938 3.78125C12.9062 3.5625 12.9062 3.25 13.0938 3.0625L13.8125 2.34375C15.375 0.78125 17.9062 0.78125 19.4688 2.34375C21.0312 3.90625 21.0312 6.4375 19.4688 8L15.5625 11.9062Z"
          fill="white"
        />
      </svg>`

  const buttonRect = buttonRef.value.getBoundingClientRect()
  const targetRect = targetRef.value.getBoundingClientRect()
  const iconWidth = 22
  const left = buttonRect.left + buttonRect.width / 2 - iconWidth / 2
  const top = buttonRect.top - 30
  const x =
    targetRect.left +
    targetRect.width / 2 -
    (buttonRect.left + buttonRect.width / 2)
  const y = targetRect.top - buttonRect.top
  console.log(targetRect)
  iconEle.style.setProperty('--left', `${left}px`)
  iconEle.style.setProperty('--top', `${top}px`)
  iconEle.style.setProperty('--x', `${x}px`)
  iconEle.style.setProperty('--y', `${y}px`)
  iconEle.addEventListener('animationend', () => {
    iconEle.remove()
  })
  return iconEle
}

const handleAddEvent = () => {
  const iconEle = createAddIcon()
  containerRef.value.appendChild(iconEle)
}
</script>

<style lang="scss">
.btn {
  position: fixed;
  top: 50%;
  left: 35%;
}
.target {
  position: fixed;
  top: 75%;
  left: 95%;
}
.add-card {
  position: fixed;
  top: var(--top);
  left: var(--left);
  animation: moveY 0.8s cubic-bezier(0.5, -0.5, 1, 1);

  & svg {
    animation: moveX 0.8s linear;
  }
}

@keyframes moveY {
  to {
    transform: translateY(var(--y));
  }
}

@keyframes moveX {
  to {
    transform: translateX(var(--x));
  }
}
</style>
